{% extends "base.html" %}
{% load i18n %}
{% load misc %}

{% block title %}{% trans "Subscribe to Event" %}{% endblock %}
{% block heading %}{% trans "Subscribe to Event" %}{% endblock %}
{% block contenttype %}prefs{% endblock %}
{% block content %}
<ul id="tabs">
  <li><a href="{% url my_nodes %}">{% trans "My nodes" %}</a></li>
  <li><a href="{% url new_node %}">{% trans "New node" %}</a></li>
  <li><a href="{% url my_whitelist %}">{% trans "MAC whitelist" %}</a></li>
  <li class="active">{% trans "Events" %}</li>
  <li><a href="{% url my_sticker %}">{% trans "Info sticker" %}</a></li>
</ul>
<div id="tabcontent">
<h3 class="no-top-margin">{% trans "Subscribe to Event" %}</h3>

{% if form.errors %}
<div class="error">
  {% trans "<b>Oooops!</b> The following errors have ocurred while attempting to add an event subscription:" %}<br />
  <br/>
  {% for error in form.non_field_errors %}
  <i>{{ error|escape }}</i><br/>
  {% endfor %}
  {% for field in form %}
  {% for error in field.errors %}
  {{ field.label }}: <i>{{ error|escape }}</i><br/>
  {% endfor %}
  {% endfor %}
</div>
{% endif %}

{% if not user.email %}
{% include "nodes/missing_email_error.html" %}
{% endif %}

<form method="post" action="{% url my_events_subscribe %}">
{% csrf_token %}
<table border="0" width="700">
  <tr>
    <td>{{ form.type.label }}</td>
    <td>{{ form.type }}</td>
  </tr>
  <tr class="single_node_subscribe">
    <td>{{ form.node.label }}</td>
    <td>{{ form.node }}</td>
  </tr>
  <tr>
    <td>{{ form.code.label }}</td>
    <td>{{ form.code }}</td>
  </tr>
</table>
  <div class="buttons">
      {% if user.email %}
      <input type="submit" value="{% trans "Subscribe" %}" />&nbsp;
      {% endif %}
      <input type="button" value="{% trans "Cancel" %}" onclick="document.location='{% url my_events %}'" />
    </div>
</form>
</div>

<script>
  function toggleSingleNode()
  {
    if ($('#id_type').attr('value') == {{ single_node_type }}) {
      $('.single_node_subscribe').css('display', '');
    } else {
      $('.single_node_subscribe').css('display', 'none');
    }
  }

  $('#id_type').change(function(event) { toggleSingleNode(); });
  $(function() {
    toggleSingleNode();
  });
</script>
{% endblock %}
