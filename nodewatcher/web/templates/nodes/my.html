{% extends "base.html" %}
{% load i18n %}

{% block title %}My Nodes{% endblock %}

{% block content %}
<h1>My Nodes</h1>

Hello <b>{{ user.username }}</b> and welcome to Ljubljana Wifi Mesh Node Operators Center (LJW-NOC)!<br/>
<br/>

<table border="0" width="750" cellspacing="0">
  <tr class="header">
    <td width="22"></td>
    <td width="150"><b>Node name</b></td>
    <td width="100"><b>IP</b></td>
    <td width="200"><b>Last seen up</b></td>
    <td width="100"><b>Status</b></td>
    <td width="50" align="center"><b>Peers</b></td>
    <td width="50" align="center"><b>MIN</b></td>
    <td width="50" align="center"><b>AVG</b></td>
    <td width="50" align="center"><b>MAX</b></td>
  </tr>
  {% if not nodes %}
  <tr>
    <td colspan="8" class="notice">
      You currently have no nodes defined. You can use <b>Register a new node</b> option below the node list to register a new node. If you don't have any IP/subnet allocations, you will be allocated some during the node registration process. The node registration process can also generate a flashable image for you, so you can set up your router directly.
    </td>
  </tr>
  {% else %}
  {% for node in nodes %}
  <tr>
    <td align="center">
      {% if node.warnings %}
      <a href="/nodes/node/{{ node.ip }}">
        <img src="http://nodes.wlan-lj.net/images/warnings_small.png" title="{% trans "Some problems were detected with this node! Click for details." %}" border="0" />
      </a>
      {% endif %}
    </td>
    <td><a href="/nodes/node/{{ node.ip }}">{{ node.name|default:"unknown" }}</a></td>
    <td>{{ node.ip }}</td>
    <td>{{ node.last_seen|default:"?" }}</td>
    <td class="node_status_{{ node.status_as_string }}">{{ node.status_as_string }}</td>
    <td align="center">{{ node.peers }}</td>
    <td align="center">{{ node.rtt_min|default:"/" }}</td>
    <td align="center">{{ node.rtt_avg|default:"/" }}</td>
    <td align="center">{{ node.rtt_max|default:"/" }}</td>
  </tr>
  {% endfor %}
  {% endif %}
  <tr class="header">
    <td width="22"></td>
    <td width="150"><b>Node name</b></td>
    <td width="100"><b>IP</b></td>
    <td width="200"><b>Last seen up</b></td>
    <td width="100"><b>Status</b></td>
    <td width="50" align="center"><b>Peers</b></td>
    <td width="50" align="center"><b>MIN</b></td>
    <td width="50" align="center"><b>AVG</b></td>
    <td width="50" align="center"><b>MAX</b></td>
  </tr>
</table>
{% if whitelist %}
<br/>
Whitelisted MAC addresses:<br/>
<table border="0" width="750" cellspacing="0">
  <tr class="header">
    <td width="22"></td>
    <td><b>MAC address</b></td>
    <td width="200"><b>Registred at</b></td>
  </tr>
  {% for item in whitelist %}
  <tr>
    <td align="center"><a href="/nodes/unwhitelist_mac/{{ item.id }}" title="Unwhitelist {{ item.mac }}">X</a></td>
    <td>{{ item.mac }}</td>
    <td>{{ item.registred_at }}</td>
  </tr>
  {% endfor %}
  <tr class="header">
    <td width="22"></td>
    <td><b>MAC address</b></td>
    <td width="200"><b>Registred at</b></td>
  </tr>
</table>
{% endif %}
<br/>
Options:
<ul>
  <li><a href="/nodes/new">Register a new node</a></li>
  <li><a href="/nodes/whitelist_mac">Whitelist a MAC address</a></li>
</ul>
<br /><br/>
{% endblock %}
